{% load static %}
<!DOCTYPE html>
<html lang="et">
  <head>
    {% if not DEBUG %}
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-XXL6GPXKCF"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-XXL6GPXKCF');
    </script>
    {% endif %}
    
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Perekas | Korralda pereelu ühes kohas</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap"
      rel="stylesheet"
    >
    <link rel="stylesheet" href="{% static 'styles.css' %}?v={{ timestamp }}">
  </head>
  <body class="landing-body">
    <div class="landing-background"></div>
    
    <header class="landing-nav">
      <a href="#hero" class="landing-brand">
        <img src="{% static 'logos/perekas-logo.png' %}" alt="Perekas" class="landing-logo" />
        <div>
          <span class="landing-brand-title">Perekas</span>
          <span class="landing-brand-tagline">Koos iga päev</span>
        </div>
      </a>
      <nav class="landing-nav-links">
        <a href="#hero">Kodu</a>
        <a href="#features">Võimalused</a>
        <a href="#plans">Paketid</a>
      </nav>
      <div class="landing-nav-actions">
        <a class="landing-link" href="{% url 'account_login' %}">Logi sisse</a>
        <a class="landing-button primary" href="{% url 'account_signup' %}">Alusta tasuta</a>
      </div>
      <button class="landing-nav-toggle" aria-label="Lülita menüü">
        <span aria-hidden="true"></span>
      </button>
    </header>

    <!-- Mobile Menu Overlay -->
    <div class="mobile-menu-overlay" id="mobileMenuOverlay">
      <div class="mobile-menu-sidebar">
        <div class="mobile-menu-header">
          <a href="#hero" class="landing-brand">
            <img src="{% static 'logos/perekas-logo.png' %}" alt="Perekas" class="landing-logo" />
            <div>
              <span class="landing-brand-title">Perekas</span>
              <span class="landing-brand-tagline">Koos iga päev</span>
            </div>
          </a>
          <button class="mobile-menu-close" aria-label="Sulge menüü">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <line x1="18" y1="6" x2="6" y2="18"></line>
              <line x1="6" y1="6" x2="18" y2="18"></line>
            </svg>
          </button>
        </div>
        <nav class="mobile-menu-links">
          <a href="#hero">Kodu</a>
          <a href="#features">Võimalused</a>
          <a href="#plans">Paketid</a>
        </nav>
        <div class="mobile-menu-separator"></div>
        <div class="mobile-menu-actions">
          <a class="mobile-menu-login" href="{% url 'account_login' %}">Logi sisse</a>
          <a class="landing-button primary mobile-menu-cta" href="{% url 'account_signup' %}">Alusta tasuta</a>
        </div>
      </div>
    </div>

    <main class="landing-main">
      <!-- Hero Section - 100vh -->
      <section class="hero-full" id="hero">
        <div class="hero-content scroll-fade-in">
          <h1 class="hero-headline-split">
            <span class="hero-headline-line">Selgem pereelu algab</span>
            <span class="hero-headline-line hero-headline-accent">ühest kohast.</span>
          </h1>
          <p class="hero-description">
            Perekas toob ülesanded, preemiad ja ostunimekirjad mugavalt kokku, et pere saaks tegutseda ühtse meeskonnana. Vanematel on rahulik ülevaade, lastel selged eesmärgid ja kodune elu muutub lihtsamaks.
          </p>
          <div class="hero-actions">
            <a class="landing-button primary" href="{% url 'account_signup' %}">Alusta tasuta</a>
            <a class="landing-button ghost" href="#features">Vaata funktsioone</a>
          </div>
        </div>
        <div class="hero-visual scroll-scale">
          <div class="hero-visual-glow" aria-hidden="true"></div>
          <div class="hero-task-demo-card">
            <!-- Animated Task Input -->
            <div class="hero-task-input-wrapper">
              <div class="hero-task-input-card">
                <input 
                  type="text" 
                  id="hero-task-input" 
                  class="hero-task-input" 
                  placeholder="Kirjuta ülesanne..."
                  readonly
                  aria-label="Näidis ülesande sisestus"
                >
                <button type="button" class="hero-task-submit" id="hero-task-submit" aria-label="Lisa ülesanne">
                  <span aria-hidden="true">+</span>
                  <span>Lisa</span>
                </button>
              </div>
            </div>
            
            <!-- Animated Task Cards -->
            <div class="hero-task-cards-container">
              <div class="hero-task-cards-wrapper" id="hero-task-cards-wrapper">
                <!-- Task cards will be dynamically added here -->
              </div>
            </div>
          </div>
          <div class="hero-dashboard-preview" style="display: none;">
            <div class="hero-dashboard-header">
              <div class="hero-dashboard-title">
                <div class="hero-dashboard-icon-wrapper">
                  <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
                    <circle cx="9" cy="7" r="4"></circle>
                    <path d="M23 21v-2a4 4 0 0 0-3-3.87"></path>
                    <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
                  </svg>
                </div>
                <div>
                  <strong>Perekond Tamm</strong>
                  <span>Täna</span>
                </div>
              </div>
            </div>
            <div class="hero-dashboard-content">
              <div class="hero-dashboard-section hero-dashboard-tasks">
                <div class="hero-section-header">
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <polyline points="9 11 12 14 22 4"></polyline>
                    <path d="M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11"></path>
                  </svg>
                  <h4>Ülesanded</h4>
                </div>
                <div class="hero-task-list">
                  <div class="hero-task-item-new">
                    <div class="hero-task-check-new completed">✓</div>
                    <div class="hero-task-content">
                      <strong>Liis</strong>
                      <span>Koolitöö ära tehtud</span>
                    </div>
                    <span class="hero-task-points-new">+30</span>
                  </div>
                  <div class="hero-task-item-new">
                    <div class="hero-task-check-new completed">✓</div>
                    <div class="hero-task-content">
                      <strong>Mart</strong>
                      <span>Koeraga jalutuskäik</span>
                    </div>
                    <span class="hero-task-status-new">Valmis</span>
                  </div>
                  <div class="hero-task-item-new">
                    <div class="hero-task-check-new"></div>
                    <div class="hero-task-content">
                      <strong>Kertu</strong>
                      <span>Tuba korras</span>
                    </div>
                    <span class="hero-task-status-new">Ootel</span>
                  </div>
                </div>
              </div>

              <div class="hero-dashboard-section hero-dashboard-rewards">
                <div class="hero-section-header">
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"></polygon>
                  </svg>
                  <h4>Preemiad</h4>
                </div>
                <div class="hero-reward-list">
                  <div class="hero-reward-item-new">
                    <div class="hero-reward-icon-new">⭐</div>
                    <div class="hero-reward-content">
                      <strong>Kertu</strong>
                      <span>Mänguõhtu</span>
                    </div>
                    <span class="hero-reward-badge-new">Vastu võetud</span>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- Features Section -->
      <section class="section-seamless" id="features">
        <div class="container-modern">
          <div class="features-grid-product">
            <div class="feature-card-product scroll-scale scroll-delay-1">
              <div class="feature-icon-product">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <polyline points="9 11 12 14 22 4"></polyline>
                  <path d="M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11"></path>
                </svg>
              </div>
              <h3>Ülesannete jagamine</h3>
              <p>Määra ja jälgi pereülesandeid ühes selges vaates. Igal pereliikmel on oma roll ning kõik tehtud ja tegemata toimetused on alati arusaadavalt nähtavad.</p>
            </div>
            <div class="feature-card-product scroll-scale scroll-delay-2">
              <div class="feature-icon-product">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"></polygon>
                </svg>
              </div>
              <h3>Punktisüsteem</h3>
              <p>Toeta laste iseseisvust ja motiveeri neid punktide ning läbimõeldud tasudega. Lapsed näevad oma edusamme ja saavad valida endale sobiva preemia, mis muudab panustamise päriselt motiveerivaks.</p>
            </div>
            <div class="feature-card-product scroll-scale scroll-delay-3">
              <div class="feature-icon-product">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <path d="M6 2L3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4z"></path>
                  <line x1="3" y1="6" x2="21" y2="6"></line>
                  <path d="M16 10a4 4 0 0 1-8 0"></path>
                </svg>
              </div>
              <h3>Ühine ostunimekiri</h3>
              <p>Reaalajas sünkroonitud ostunimekirjad, mida kogu pere saab kasutada. Lisa, jaga ja märgi tooted kiiresti ära — nii teab igaüks täpselt, mida poest tuua.</p>
            </div>
            <div class="feature-card-product scroll-scale scroll-delay-4">
              <div class="feature-icon-product">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                  <polyline points="14 2 14 8 20 8"></polyline>
                  <line x1="12" y1="18" x2="12" y2="12"></line>
                  <line x1="9" y1="15" x2="15" y2="15"></line>
                </svg>
              </div>
              <h3>Ülesannete lisamine hetkega</h3>
              <p>Lisa ülesandeid hetkega — määra laps, tähtaeg, prioriteet ja punktid otse tekstis. Näide: Vii prügi välja @Emma homme !kõrge +50.</p>
            </div>
            <div class="feature-card-product scroll-scale scroll-delay-5">
              <div class="feature-icon-product">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <path d="M1 4v6h6"></path>
                  <path d="M23 20v-6h-6"></path>
                  <path d="M20.49 9A9 9 0 0 0 5.64 5.64L1 10m22 4l-4.64 4.36A9 9 0 0 1 3.51 15"></path>
                </svg>
              </div>
              <h3>Korduvad ülesanded</h3>
              <p>Seadista ülesanded korduma automaatselt ja lase neil iga päev, nädal või kuu end ise uuesti luua — nii säästad aega ja ei pea midagi meelde jätma.</p>
            </div>
            <div class="feature-card-product scroll-scale scroll-delay-6">
              <div class="feature-icon-product">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path>
                  <polyline points="22 4 12 14.01 9 11.01"></polyline>
                </svg>
              </div>
              <h3>Ülesannete kinnitamine</h3>
              <p>Lapsed märgivad ülesanded tehtuks ja vanemad kinnitavad need — nii on kõik tehtud tööd selgelt nähtavad ning peres valitseb selgus ja usaldus.</p>
            </div>
            {% comment %}
            <div class="feature-card-product scroll-scale scroll-delay-6">
              <div class="feature-icon-product">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <circle cx="12" cy="12" r="10"></circle>
                  <polyline points="12 6 12 12 16 14"></polyline>
                </svg>
              </div>
              <h3>Reaalajas sünkroonimine</h3>
              <p>Kõik muudatused uuenevad kohe kõigis seadmetes. Ei pea ootama või värskendama lehte.</p>
            </div>
            <div class="feature-card-product scroll-scale scroll-delay-7">
              <div class="feature-icon-product">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"></path>
                </svg>
              </div>
              <h3>Turbekaitstud</h3>
              <p>Kõik andmed on turvaliselt kaitstud. Saad kontrollida, kes mida näeb ja teeb.</p>
            </div>
            {% endcomment %}
          </div>
        </div>
      </section>

      <!-- Transition Section -->
      <section class="section-seamless section-transition">
        <div class="container-modern">
          <div class="transition-content scroll-fade-in">
            <h2 class="transition-headline">Kõik ühes kohas. Lihtne, selge, efektiivne.</h2>
            <p class="transition-description">
              Perekas koondab kõik vajalikud tööriistad ühte platvormi. Vanematel on lihtsam planeerida, lastel on selged ootused ja kogu pere töötab sujuvalt koos.
            </p>
          </div>
        </div>
      </section>

      <!-- Testimonials Section -->
      <section class="section-seamless" id="testimonials">
        <div class="container-modern">
          <div class="testimonials-scroll-wrapper">
            <div class="testimonials-grid-supabase">
              <div class="testimonial-card-supabase scroll-slide-up scroll-delay-1">
                <p class="testimonial-quote-supabase">"Perekas on meie pereelu palju lihtsamaks teinud. Ülesanded on nüüd selgelt määratud ja lapsed teavad täpselt, mida oodatakse."</p>
                <div class="testimonial-author-supabase">
                  <div class="testimonial-avatar-supabase">PT</div>
                  <div class="testimonial-author-info">
                    <div class="testimonial-author-name-supabase">Perekond Tamm</div>
                    <div class="testimonial-author-location-supabase">Tallinn</div>
                  </div>
                </div>
              </div>
              <div class="testimonial-card-supabase scroll-slide-up scroll-delay-2">
                <p class="testimonial-quote-supabase">"Meie teismelised jälgivad oma ülesandeid ja koguvad punkte ise. See on muutnud igapäevaelu palju sujuvamaks ja motiveerivaks."</p>
                <div class="testimonial-author-supabase">
                  <div class="testimonial-avatar-supabase">PS</div>
                  <div class="testimonial-author-info">
                    <div class="testimonial-author-name-supabase">Perekond Saar</div>
                    <div class="testimonial-author-location-supabase">Tartu</div>
                  </div>
                </div>
              </div>
              <div class="testimonial-card-supabase scroll-slide-up scroll-delay-3">
                <p class="testimonial-quote-supabase">"Ostunimekirja funktsioon on imeline — kogu pere saab lisada vajalikke tooteid ja märkida, mis on juba ostetud. Ei mingit segadust!"</p>
                <div class="testimonial-author-supabase">
                  <div class="testimonial-avatar-supabase">PM</div>
                  <div class="testimonial-author-info">
                    <div class="testimonial-author-name-supabase">Perekond Mets</div>
                    <div class="testimonial-author-location-supabase">Pärnu</div>
                  </div>
                </div>
              </div>
              <div class="testimonial-card-supabase scroll-slide-up scroll-delay-4">
                <p class="testimonial-quote-supabase">"Lapsed armastavad punktisüsteemi. Nad näevad oma saavutusi ja tunnevad suuremat vastutust, mis teeb kodused toimetused lõbusamaks."</p>
                <div class="testimonial-author-supabase">
                  <div class="testimonial-avatar-supabase">PK</div>
                  <div class="testimonial-author-info">
                    <div class="testimonial-author-name-supabase">Perekond Kask</div>
                    <div class="testimonial-author-location-supabase">Viljandi</div>
                  </div>
                </div>
              </div>
              <div class="testimonial-card-supabase scroll-slide-up scroll-delay-5">
                <p class="testimonial-quote-supabase">"Kõik vajalik ühes kohas: ülesanded, preemiad ja ostunimekirjad. See on aidanud meil peres selget korda luua ja stressi vähendada."</p>
                <div class="testimonial-author-supabase">
                  <div class="testimonial-avatar-supabase">PL</div>
                  <div class="testimonial-author-info">
                    <div class="testimonial-author-name-supabase">Perekond Lepp</div>
                    <div class="testimonial-author-location-supabase">Rakvere</div>
                  </div>
                </div>
              </div>
              <div class="testimonial-card-supabase scroll-slide-up scroll-delay-5">
                <p class="testimonial-quote-supabase">"Perekas motiveerib lapsi panustama ja annab vanematele rahuliku ülevaate. Igapäevased ülesanded ei ole kunagi olnud nii lihtsad."</p>
                <div class="testimonial-author-supabase">
                  <div class="testimonial-avatar-supabase">PS</div>
                  <div class="testimonial-author-info">
                    <div class="testimonial-author-name-supabase">Perekond Sirel</div>
                    <div class="testimonial-author-location-supabase">Tartu</div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- Plans Section -->
      <section class="section-seamless" id="plans">
        <div class="container-modern">
          <div class="pricing-header-inline scroll-fade-in">
            <div>
              <h2>Vali sobiv pakett</h2>
              <p class="pricing-subtitle-inline">Alusta tasuta ja testi kõiki põhifunktsioone</p>
            </div>
            <div class="pricing-toggle-wrapper-modern">
              <div class="pricing-toggle-modern">
                <span class="pricing-toggle-label">Kuu</span>
                <button class="pricing-toggle-switch-modern" id="pricingToggle" aria-label="Lülita hinnakujundus">
                  <span class="pricing-toggle-slider-modern"></span>
                </button>
                <span class="pricing-toggle-label">Aasta <span class="pricing-save-badge-modern">Säästa 20%</span></span>
              </div>
            </div>
          </div>
          <div class="plans-grid-modern">
            <article class="plan-card-modern scroll-scale scroll-delay-1">
              <div class="plan-header-modern">
                <h3>TASUTA</h3>
              </div>
              <div class="plan-price-modern">
                <span class="plan-price-monthly active">€0<span>/kuu</span></span>
                <span class="plan-price-yearly">€0<span>/aasta</span></span>
              </div>
              <ul class="plan-features-modern">
                <li>1 lapsevanem</li>
                <li>1 laps</li>
                <li>30 ülesannet kuus</li>
                <li>4 preemiat kuus</li>
                <li class="no-access">Ostunimekiri puudub</li>
              </ul>
              <a class="landing-button secondary plan-button-modern" href="{% url 'account_signup' %}">Alusta tasuta</a>
            </article>

            <article class="plan-card-modern plan-featured-modern scroll-scale scroll-delay-2">
              <div class="plan-popular-badge-modern">Kõige populaarsem</div>
              <div class="plan-header-modern">
                <h3>ALUSTAJA</h3>
              </div>
              <div class="plan-price-modern">
                <span class="plan-price-monthly active">€7<span>/kuu</span></span>
                <span class="plan-price-yearly">€67<span>/aasta</span></span>
              </div>
              <ul class="plan-features-modern">
                <li>2 lapsevanemat</li>
                <li>2 last</li>
                <li>45 ülesannet kuus</li>
                <li>10 preemiat kuus</li>
                <li>Ostunimekirja ligipääs</li>
              </ul>
              <a class="landing-button primary plan-button-modern" href="{% url 'account_signup' %}">Vali pakett</a>
            </article>

            <article class="plan-card-modern scroll-scale scroll-delay-3">
              <div class="plan-header-modern">
                <h3>PRO</h3>
              </div>
              <div class="plan-price-modern">
                <span class="plan-price-monthly active">€15<span>/kuu</span></span>
                <span class="plan-price-yearly">€144<span>/aasta</span></span>
              </div>
              <ul class="plan-features-modern">
                <li>2 lapsevanemat</li>
                <li>5 last</li>
                <li>Piiramatult ülesandeid</li>
                <li>50 preemiat kuus</li>
                <li>Ostunimekirja ligipääs</li>
              </ul>
              <a class="landing-button secondary plan-button-modern" href="{% url 'account_signup' %}">Vali pakett</a>
            </article>
          </div>
        </div>
      </section>

      <!-- CTA Section -->
      <section class="section-seamless section-cta-seamless" id="get-started">
        <div class="container-modern">
          <div class="cta-content-flowing scroll-slide-up">
            <h2 class="cta-headline-flowing">Lihtsam igapäevaelu algab siit</h2>
            <p class="cta-description-flowing">Testi kõiki põhifunktsioone kohe — tasuta ja ilma krediitkaardita. Tee pereelu lihtsamaks juba täna!</p>
            <div class="cta-actions-modern">
              <a class="landing-button primary cta-button-large" href="{% url 'account_signup' %}">Alusta tasuta</a>
            </div>
          </div>
        </div>
      </section>
    </main>

    {% include 'a_landing/partials/footer.html' %}

    <script>
      const toggle = document.querySelector('.landing-nav-toggle');
      const mobileMenuOverlay = document.getElementById('mobileMenuOverlay');
      const mobileMenuClose = document.querySelector('.mobile-menu-close');
      
      if (toggle && mobileMenuOverlay) {
        toggle.addEventListener('click', () => {
          mobileMenuOverlay.classList.add('active');
          document.body.style.overflow = 'hidden';
        });
      }
      
      function closeMobileMenu() {
        if (mobileMenuOverlay) {
          mobileMenuOverlay.classList.remove('active');
          document.body.style.overflow = '';
        }
      }
      
      if (mobileMenuClose) {
        mobileMenuClose.addEventListener('click', closeMobileMenu);
      }
      
      if (mobileMenuOverlay) {
        mobileMenuOverlay.addEventListener('click', (e) => {
          if (e.target === mobileMenuOverlay) {
            closeMobileMenu();
          }
        });
      }
      
      // Close menu when clicking on a link
      const mobileMenuLinks = document.querySelectorAll('.mobile-menu-links a, .mobile-menu-actions a');
      mobileMenuLinks.forEach(link => {
        link.addEventListener('click', () => {
          setTimeout(closeMobileMenu, 100);
        });
      });

      // Smooth scroll for anchor links
      document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener('click', function (e) {
          const href = this.getAttribute('href');
          if (href !== '#' && href.length > 1) {
            e.preventDefault();
            const target = document.querySelector(href);
            if (target) {
              const headerOffset = 80;
              const elementPosition = target.getBoundingClientRect().top;
              const offsetPosition = elementPosition + window.pageYOffset - headerOffset;

              window.scrollTo({
                top: offsetPosition,
                behavior: 'smooth'
              });
            }
          }
        });
      });

      // Handle hash anchor on page load
      window.addEventListener('load', () => {
        if (window.location.hash) {
          const hash = window.location.hash;
          const target = document.querySelector(hash);
          if (target) {
            setTimeout(() => {
              const headerOffset = 80;
              const elementPosition = target.getBoundingClientRect().top;
              const offsetPosition = elementPosition + window.pageYOffset - headerOffset;
              window.scrollTo({
                top: offsetPosition,
                behavior: 'smooth'
              });
            }, 100);
          }
        }
      });

      // Scroll animations with Intersection Observer
      const observerOptions = {
        threshold: 0.1,
        rootMargin: '0px 0px -50px 0px'
      };

      const observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
          if (entry.isIntersecting) {
            entry.target.classList.add('visible');
          }
        });
      }, observerOptions);

      document.querySelectorAll('.scroll-fade-in, .scroll-scale, .scroll-slide-up').forEach(el => {
        observer.observe(el);
      });

      // Pricing toggle functionality
      const pricingToggle = document.getElementById('pricingToggle');
      if (pricingToggle) {
        let isYearly = false;
        const monthlyPrices = document.querySelectorAll('.plan-price-monthly');
        const yearlyPrices = document.querySelectorAll('.plan-price-yearly');
        const slider = pricingToggle.querySelector('.pricing-toggle-slider-modern');
        
        pricingToggle.addEventListener('click', function(e) {
          e.preventDefault();
          e.stopPropagation();
          isYearly = !isYearly;
          
          if (isYearly) {
            // Fade out monthly prices, then fade in yearly prices
            monthlyPrices.forEach(el => el.classList.remove('active'));
            setTimeout(() => {
              yearlyPrices.forEach(el => el.classList.add('active'));
            }, 200);
            if (slider) {
              slider.style.transform = 'translateX(26px)';
            }
            this.setAttribute('aria-checked', 'true');
          } else {
            // Fade out yearly prices, then fade in monthly prices
            yearlyPrices.forEach(el => el.classList.remove('active'));
            setTimeout(() => {
              monthlyPrices.forEach(el => el.classList.add('active'));
            }, 200);
            if (slider) {
              slider.style.transform = 'translateX(0)';
            }
            this.setAttribute('aria-checked', 'false');
          }
        });
      }

      // Hero Task Animation
      (function() {
        const heroInput = document.getElementById('hero-task-input');
        const heroSubmit = document.getElementById('hero-task-submit');
        const heroCardsWrapper = document.getElementById('hero-task-cards-wrapper');
        
        if (!heroInput || !heroSubmit || !heroCardsWrapper) return;
        
        // Example tasks to type
        const exampleTasks = [
          "Vii prügi välja @Emma homme !kõrge",
          "Koristus *igapäevaselt +30",
          "Kodutöö @Tom reedel *nädalaselt !kõrge +100",
          "Toida koera @kõik +25"
        ];
        
        // Task data for cards
        const taskData = [
          { name: "Vii prügi välja", assigned: "Emma", points: 50, priority: 2, dueDate: "homme" },
          { name: "Koristus", assigned: "Kõigile", points: 30, priority: 1, recurring: true },
          { name: "Kodutöö", assigned: "Tom", points: 100, priority: 2, recurring: true },
          { name: "Toida koera", assigned: "Kõigile", points: 25, priority: 0 }
        ];
        
        let currentTaskIndex = 0;
        let isTyping = false;
        let currentCards = [];
        
        function createTaskCard(task, isFaded = false) {
          const card = document.createElement('article');
          const priorityClass = task.priority === 2 ? 'priority-2' : task.priority === 0 ? 'priority-0' : 'priority-1';
          card.className = `task-card ${priorityClass} ${isFaded ? 'faded' : ''}`;
          
          const priorityText = task.priority === 2 ? 'Kõrge' : task.priority === 0 ? 'Madal' : 'Keskmine';
          
          card.innerHTML = `
            <div class="task-card-header">
              <div>
                <h3 class="task-name">
                  ${task.name}
                </h3>
                <p class="task-assigned">Määratud: ${task.assigned}</p>
              </div>
              <span class="task-points points-chip">
                <span class="points-value">${task.points}</span>
                <span class="points-label">pkt</span>
              </span>
            </div>
            <div class="task-meta">
              <div class="task-meta-item">
                <svg class="task-meta-icon" viewBox="0 0 24 24" aria-hidden="true">
                  <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"></path>
                </svg>
                <span class="task-meta-label">${priorityText}</span>
              </div>
              ${task.dueDate ? `
              <div class="task-meta-item">
                <svg class="task-meta-icon" viewBox="0 0 24 24" aria-hidden="true">
                  <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
                  <line x1="16" y1="2" x2="16" y2="6"></line>
                  <line x1="8" y1="2" x2="8" y2="6"></line>
                  <line x1="3" y1="10" x2="21" y2="10"></line>
                </svg>
                <span class="task-meta-label">${task.dueDate}</span>
              </div>
              ` : ''}
              ${task.recurring ? `
              <div class="task-meta-item">
                <svg class="task-meta-icon" viewBox="0 0 24 24" aria-hidden="true" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <path d="M1 4v6h6"></path>
                  <path d="M23 20v-6h-6"></path>
                  <path d="M20.49 9A9 9 0 0 0 5.64 5.64L1 10m22 4l-4.64 4.36A9 9 0 0 1 3.51 15"></path>
                </svg>
                <span class="task-meta-label">Iga päev</span>
              </div>
              ` : ''}
            </div>
          `;
          
          return card;
        }
        
        function typeText(text, callback) {
          if (isTyping) return;
          isTyping = true;
          heroInput.value = '';
          heroSubmit.classList.remove('active');
          
          let charIndex = 0;
          const typingInterval = setInterval(() => {
            if (charIndex < text.length) {
              heroInput.value = text.substring(0, charIndex + 1);
              charIndex++;
              // Scroll to end to show the latest typed text
              heroInput.scrollLeft = heroInput.scrollWidth;
            } else {
              clearInterval(typingInterval);
              // Ensure input scrolls to show the end
              setTimeout(() => {
                heroInput.scrollLeft = heroInput.scrollWidth;
              }, 10);
              // Show button animation - quick tap effect
              setTimeout(() => {
                // Quick tap down
                heroSubmit.classList.add('active');
                setTimeout(() => {
                  // Quick tap up with glow
                  heroSubmit.classList.remove('active');
                  heroSubmit.classList.add('clicked');
                  // Remove clicked state quickly for next cycle
                  setTimeout(() => {
                    heroSubmit.classList.remove('clicked');
                  }, 200);
                }, 100); // Quick tap - 100ms pressed
                
                // First, animate existing cards moving down
                currentCards.forEach((card, index) => {
                  if (index === 0) {
                    // First card (top) moves down and becomes faded
                    card.classList.add('moving-down');
                    setTimeout(() => {
                      card.classList.add('faded');
                      card.classList.remove('moving-down');
                    }, 100);
                  } else if (index === 1) {
                    // Second card moves down (becomes half-visible at bottom)
                    card.classList.add('moving-down');
                  } else if (index >= 2) {
                    // Remove any extra cards
                    card.classList.add('fading-out');
                    setTimeout(() => {
                      if (card.parentNode) {
                        card.remove();
                      }
                    }, 800);
                  }
                });
                
                // Wait a bit for cards to start moving, then add new card
                setTimeout(() => {
                  // Add new task card at the top
                  const newTask = taskData[currentTaskIndex];
                  const newCard = createTaskCard(newTask, false);
                  
                  // Insert at the beginning (top of stack)
                  heroCardsWrapper.insertBefore(newCard, heroCardsWrapper.firstChild);
                  
                  // Add to beginning of array
                  currentCards.unshift(newCard);
                  
                  // Keep only 2 cards visible (one full, one half-visible at bottom)
                  if (currentCards.length > 2) {
                    const oldCard = currentCards.pop();
                    if (oldCard && !oldCard.classList.contains('fading-out')) {
                      oldCard.classList.add('fading-out');
                      setTimeout(() => {
                        if (oldCard.parentNode) {
                          oldCard.remove();
                        }
                      }, 800);
                    }
                  }
                  
                  // Force reflow to ensure initial state is applied
                  void newCard.offsetHeight;
                  
                  // Smooth fade in the new card at the top position
                  setTimeout(() => {
                    newCard.classList.add('visible');
                  }, 100);
                  
                  // Ensure the last card (bottom) is positioned correctly for half-visibility
                  if (currentCards.length >= 2) {
                    const bottomCard = currentCards[currentCards.length - 1];
                    if (bottomCard && !bottomCard.classList.contains('visible')) {
                      bottomCard.style.position = 'absolute';
                      bottomCard.style.bottom = '0';
                      bottomCard.style.left = '0';
                      bottomCard.style.right = '0';
                      bottomCard.style.clipPath = 'inset(0 0 50% 0)';
                    }
                  }
                }, 200);
                
                // Reset for next cycle
                setTimeout(() => {
                  heroInput.value = '';
                  heroSubmit.classList.remove('clicked');
                  isTyping = false;
                  currentTaskIndex = (currentTaskIndex + 1) % exampleTasks.length;
                  setTimeout(() => {
                    typeText(exampleTasks[currentTaskIndex]);
                  }, 2000);
                }, 1000);
              }, 800);
            }
          }, 80); // Typing speed - slower
        }
        
        // Start animation after a delay
        setTimeout(() => {
          typeText(exampleTasks[0]);
        }, 2000);
      })();
    </script>
  </body>
</html>
